<style>

#manageact{
	display: none;
}

#togreg{
	display: inline-block;
	border-radius: 7px;
	border: 2px solid lightgrey;
 	background-color: #eefff8;
	text-overflow: ellipsis;
	padding: 5px;
}
#saveact{
	display: inline-block;
	border-radius: 7px;
	border: 2px solid lightgrey;
	background-color: #eefff8;
	text-overflow: ellipsis;
	padding: 5px;
}
#createactlist{
	display: inline;
}

</style>

<div id="manageact">
	
	<div id="togreg">
		<h4 id="regstatus">Registration is currently enabled</h4>
		<input class = "btn" id = "toggleRegister" type="button" value="Toggle Activitiy Registration" onclick="togglereg();"/>
	</div>
	<br><br>
    <div id="saveact">
    	<p id="regspread"></p>
     	<input type="Button" id="createactlist" class="btn" value="Update Registration Spreadsheet" onClick="updateActs();">
    </div>	
	
	<br><br>
	<h4>Edit Student Activities</h4>
	<hr>
	

</div>

<script>

/**
 * Toggle activity registration by calling server
 */
function togglereg(){
	google.script.run
	.withSuccessHandler((result) => {
		document.getElementById("regstatus").innerHTML = "Registration is currently " + result;
		document.getElementById("sturegstatus").innerHTML = "Registration is currently " + result;
		showModal(0, "Success!");
	})
	.withFailureHandler(() => showModal(0, "Action Failed"))
	.toggleRegistration();
}

/**
 * Update Activity Spreadsheet
 */
function updateActs(){
	
	document.getElementById("createactlist").value = "Making - Please Wait";
    document.getElementById("createactlist").style.backgroundColor = "#800000";
    document.getElementById("createactlist").disabled = "true";
	
	 google.script.run.withSuccessHandler(() => {
         document.getElementById("createactlist").removeAttribute("disabled");
         document.getElementById("createactlist").value = "Update Registration Spreadsheet";
         document.getElementById("createactlist").style.backgroundColor = "#32CD32";
         showModal(0, "Success!");
     }).withFailureHandler(() => {
         document.getElementById("createactlist").removeAttribute("disabled");
         document.getElementById("createactlist").value = "Update Registration Spreadsheet";
         document.getElementById("createactlist").style.backgroundColor = "#32CD32";
         showModal(0, "Operation Failed. Please Try Again or Reload the Page");
     }).makeActivitySpreadsheet();
}

</script>